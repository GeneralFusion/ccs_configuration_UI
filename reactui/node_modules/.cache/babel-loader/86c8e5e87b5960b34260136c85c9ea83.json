{"ast":null,"code":"import _regeneratorRuntime from\"C:/Code/ReactUI/React/reactui/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Code/ReactUI/React/reactui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Code/ReactUI/React/reactui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Button from'@mui/material/Button';import Client from'./Client.js';import React,{useState}from'react';import{loadYAML}from'./YAML.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var mainConfig;//Value:Label Mappings, \n//collapsbible, make scopes to names instead of numbers, change to array for order, \nfunction Controller(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),clients=_useState2[0],setClients=_useState2[1];var yamlFile=loadYAML(\"test.yml\");console.log(\"Controller rerender\");var changeValue=function changeValue(_ref){var _ref2=_slicedToArray(_ref,2),clientNumber=_ref2[0],_ref2$=_slicedToArray(_ref2[1],2),keyHistory=_ref2$[0],newValue=_ref2$[1];//Array destructuring. Will take the array of property and value and make it into two variables. \nvar client=mainConfig[clientNumber];//console.log(client);\nconsole.log(keyHistory);console.log(newValue);for(var i=0;i<keyHistory.length-1;i++){//Go through keyhistory (except last one). Now client is pointing to the last object which is the {proprety: value}.\nclient=client[keyHistory[i]];}client[keyHistory[keyHistory.length-1]]=newValue;//     console.log(client);\nconsole.log(mainConfig);};var generateClients=function generateClients(json,propertiesDB,scopesDB){var tempArray=[];for(var _i=0,_Object$entries=Object.entries(json);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),clientNumber=_Object$entries$_i[0],clientData=_Object$entries$_i[1];tempArray.push(/*#__PURE__*/_jsx(Client,{sx:{},clientNumber:clientNumber,properties:clientData,propertiesDB:propertiesDB,scopesDB:scopesDB,onValueChange:changeValue},clientNumber));}return tempArray;};var getData=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var req,json;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"/getData/\",{method:'GET'});case 3:req=_context.sent;_context.next=6;return req.json();case 6:json=_context.sent;return _context.abrupt(\"return\",json);case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log(\"Error fetching data\");case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function getData(){return _ref3.apply(this,arguments);};}();var initController=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var data,propertiesDB,scopesDB,tempClients;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getData();case 2:data=_context2.sent;propertiesDB=data['propertiesDB'];scopesDB=data['scopesDB'];console.log(data);mainConfig=data['clients'];tempClients=generateClients(data['clients'],propertiesDB,scopesDB);//Properties DB seems to be passes by reference\nsetClients(tempClients);case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function initController(){return _ref4.apply(this,arguments);};}();var saveChanges=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"Saving: \");_context3.prev=1;_context3.next=4;return fetch(\"/getData/\",{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(mainConfig)});case 4:_context3.next=9;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](1);console.log(_context3.t0);case 9:case\"end\":return _context3.stop();}}},_callee3,null,[[1,6]]);}));return function saveChanges(){return _ref5.apply(this,arguments);};}();if(clients.length>0){return/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center'},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Controls\"}),clients,/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:function onClick(){return saveChanges();},children:\"Save Changes\"})]});}else{return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"success\",onClick:function onClick(){return initController();},children:\"Get Data\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"Waiting for clients...\"})]});}}export default Controller;","map":{"version":3,"names":["Button","Client","React","useState","loadYAML","mainConfig","Controller","props","clients","setClients","yamlFile","console","log","changeValue","clientNumber","keyHistory","newValue","client","i","length","generateClients","json","propertiesDB","scopesDB","tempArray","Object","entries","clientData","push","getData","fetch","method","req","initController","data","tempClients","saveChanges","headers","body","JSON","stringify","textAlign"],"sources":["C:/Code/ReactUI/React/reactui/src/Controller.js"],"sourcesContent":["import Button from '@mui/material/Button';\r\nimport Client from './Client.js';\r\nimport React, { useState } from 'react';\r\n\r\nimport {loadYAML} from './YAML.js';\r\nlet mainConfig;\r\n//Value:Label Mappings, \r\n//collapsbible, make scopes to names instead of numbers, change to array for order, \r\nfunction Controller(props){\r\n    const [clients, setClients] = useState([]);\r\n\r\n    const yamlFile = loadYAML(\"test.yml\");\r\n    console.log(\"Controller rerender\");\r\n    \r\n    const changeValue = ([clientNumber, [keyHistory, newValue]]) => {//Array destructuring. Will take the array of property and value and make it into two variables. \r\n        let client = mainConfig[clientNumber];\r\n        //console.log(client);\r\n        console.log(keyHistory);\r\n        console.log(newValue);\r\n        for(let i = 0; i < keyHistory.length - 1; i++){//Go through keyhistory (except last one). Now client is pointing to the last object which is the {proprety: value}.\r\n            client = client[keyHistory[i]];\r\n        }\r\n        client[keyHistory[keyHistory.length - 1]] = newValue;\r\n    //     console.log(client);\r\n        console.log(mainConfig);\r\n    }\r\n    const generateClients = (json, propertiesDB, scopesDB) => {\r\n        let tempArray = [];\r\n        for(const [clientNumber, clientData] of Object.entries(json)){\r\n            tempArray.push(<Client sx={{}}key={clientNumber} clientNumber={clientNumber} properties={clientData} propertiesDB={propertiesDB} scopesDB={scopesDB} onValueChange={changeValue}></Client>);\r\n        }\r\n        return tempArray;\r\n    }\r\n\r\n    const getData = async () => {\r\n        try{\r\n            const req = await fetch(`/getData/`, {method: 'GET'});\r\n            const json = await req.json();\r\n            return json;\r\n        }\r\n        catch(err){\r\n            console.log(\"Error fetching data\");\r\n        }\r\n\r\n    }\r\n    const initController = async () => {\r\n        const data = await getData();\r\n        const propertiesDB = data['propertiesDB'];\r\n        const scopesDB = data['scopesDB'];\r\n        console.log(data);\r\n        mainConfig = data['clients'];\r\n        let tempClients = generateClients(data['clients'], propertiesDB, scopesDB);//Properties DB seems to be passes by reference\r\n        setClients(tempClients);\r\n    }\r\n\r\n    const saveChanges = async () => {\r\n        console.log(\"Saving: \");\r\n        try{\r\n            await fetch(`/getData/`, \r\n                {\r\n                    method:'POST', \r\n                    headers:{'Content-Type':'application/json'}, \r\n                    body: JSON.stringify(mainConfig)\r\n                }\r\n            );\r\n        }\r\n        catch(err){\r\n            console.log(err);\r\n        }\r\n    }\r\n\r\n\r\n    if(clients.length > 0){\r\n        return(\r\n            <div style={{textAlign: 'center'}}>\r\n                <h1>\r\n                    Controls\r\n                </h1>\r\n                {clients}\r\n                {/* <Client properties={properties} onValueChange={changeValue}></Client> */}\r\n                {/* <ValueChanger onValueChange={sendChange} name=\"temperature\" value={10}></ValueChanger> */}\r\n                <Button variant=\"contained\" color=\"primary\" onClick={() => saveChanges()}>Save Changes</Button>\r\n            </div>\r\n        )\r\n    }\r\n    else{\r\n        return(\r\n            <div>\r\n                <Button variant=\"contained\" color=\"success\" onClick={() => initController()}>Get Data</Button>\r\n                <h1>Waiting for clients...</h1>\r\n            </div>\r\n            \r\n        )\r\n    }\r\n}\r\n\r\n\r\nexport default Controller;\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}