{"ast":null,"code":"var _jsxFileName = \"C:\\\\Code\\\\ReactUI\\\\React\\\\reactui\\\\src\\\\Controller.js\",\n    _s = $RefreshSig$();\n\nimport Button from '@mui/material/Button';\nimport LoadingButton from '@mui/lab/LoadingButton';\nimport Client from './Client.js';\nimport React, { useState } from 'react';\nimport { loadYAML } from './YAML.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet mainConfig; //Value:Label Mappings,\n//collapsbible, make scopes to names instead of numbers, change to array for order,\n\nfunction Controller(props) {\n  _s();\n\n  const [clients, setClients] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const yamlFile = loadYAML('test.yml');\n  console.log('Controller rerender');\n\n  const changeValue = _ref => {\n    let [clientNumber, [keyHistory, newValue]] = _ref;\n    //Array destructuring. Will take the array of property and value and make it into two variables.\n    let client = mainConfig[clientNumber]; //console.log(client);\n\n    console.log(keyHistory);\n    console.log(newValue);\n\n    for (let i = 0; i < keyHistory.length - 1; i++) {\n      //Go through keyhistory (except last one). Now client is pointing to the last object which is the {proprety: value}.\n      client = client[keyHistory[i]];\n    }\n\n    client[keyHistory[keyHistory.length - 1]] = newValue; //     console.log(client);\n\n    console.log(mainConfig);\n  };\n\n  const generateClients = (json, propertiesDB, scopesDB) => {\n    let tempArray = [];\n\n    for (const [clientNumber, clientData] of Object.entries(json)) {\n      tempArray.push( /*#__PURE__*/_jsxDEV(Client, {\n        sx: {},\n        clientNumber: clientNumber,\n        properties: clientData,\n        propertiesDB: propertiesDB,\n        scopesDB: scopesDB,\n        onValueChange: changeValue\n      }, clientNumber, false, {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 17\n      }, this));\n    }\n\n    return tempArray;\n  };\n\n  const getData = async () => {\n    try {\n      const req = await fetch(`/getData/`, {\n        method: 'GET'\n      });\n      const json = await req.json();\n      return json;\n    } catch (err) {\n      console.log('Error fetching data');\n    }\n  };\n\n  const initController = async () => {\n    const data = await getData();\n    const propertiesDB = data['propertiesDB'];\n    const scopesDB = data['scopesDB'];\n    console.log(data);\n    mainConfig = data['clients'];\n    let tempClients = generateClients(data['clients'], propertiesDB, scopesDB); //Properties DB seems to be passes by reference\n\n    setClients(tempClients);\n  };\n\n  const saveChanges = async () => {\n    console.log('Saving: ');\n\n    try {\n      await fetch(`/getData/`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(mainConfig)\n      });\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  if (clients.length > 0) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        textAlign: 'center',\n        marginBottom: 20\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Controls\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this), clients, /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: () => saveChanges(),\n        sx: {\n          marginTop: 1,\n          width: 1\n        },\n        children: \"Save Changes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: '50px'\n      },\n      children: /*#__PURE__*/_jsxDEV(LoadingButton, {\n        onClick: () => {\n          setIsLoading(true);\n          initController();\n        },\n        loading: isLoading,\n        loadingIndicator: \"Loading\\u2026\",\n        variant: \"contained\",\n        children: \"Fetch data\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 19\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }, this);\n  }\n}\n\n_s(Controller, \"1ovG9cuC7PP/FzRKTqcl9ql70w8=\");\n\n_c = Controller;\nexport default Controller;\n\nvar _c;\n\n$RefreshReg$(_c, \"Controller\");","map":{"version":3,"names":["Button","LoadingButton","Client","React","useState","loadYAML","mainConfig","Controller","props","clients","setClients","isLoading","setIsLoading","yamlFile","console","log","changeValue","clientNumber","keyHistory","newValue","client","i","length","generateClients","json","propertiesDB","scopesDB","tempArray","clientData","Object","entries","push","getData","req","fetch","method","err","initController","data","tempClients","saveChanges","headers","body","JSON","stringify","textAlign","marginBottom","marginTop","width"],"sources":["C:/Code/ReactUI/React/reactui/src/Controller.js"],"sourcesContent":["import Button from '@mui/material/Button'\r\nimport LoadingButton from '@mui/lab/LoadingButton';\r\nimport Client from './Client.js'\r\nimport React, { useState } from 'react'\r\n\r\nimport { loadYAML } from './YAML.js'\r\nlet mainConfig\r\n//Value:Label Mappings,\r\n//collapsbible, make scopes to names instead of numbers, change to array for order,\r\nfunction Controller(props) {\r\n    const [clients, setClients] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(false)\r\n    const yamlFile = loadYAML('test.yml')\r\n    console.log('Controller rerender')\r\n\r\n    const changeValue = ([clientNumber, [keyHistory, newValue]]) => {\r\n        //Array destructuring. Will take the array of property and value and make it into two variables.\r\n        let client = mainConfig[clientNumber]\r\n        //console.log(client);\r\n        console.log(keyHistory)\r\n        console.log(newValue)\r\n        for (let i = 0; i < keyHistory.length - 1; i++) {\r\n            //Go through keyhistory (except last one). Now client is pointing to the last object which is the {proprety: value}.\r\n            client = client[keyHistory[i]]\r\n        }\r\n        client[keyHistory[keyHistory.length - 1]] = newValue\r\n        //     console.log(client);\r\n        console.log(mainConfig)\r\n    }\r\n    const generateClients = (json, propertiesDB, scopesDB) => {\r\n        let tempArray = []\r\n        for (const [clientNumber, clientData] of Object.entries(json)) {\r\n            tempArray.push(\r\n                <Client\r\n                    sx={{}}\r\n                    key={clientNumber}\r\n                    clientNumber={clientNumber}\r\n                    properties={clientData}\r\n                    propertiesDB={propertiesDB}\r\n                    scopesDB={scopesDB}\r\n                    onValueChange={changeValue}\r\n                ></Client>\r\n            )\r\n        }\r\n        return tempArray\r\n    }\r\n\r\n    const getData = async () => {\r\n        try {\r\n            const req = await fetch(`/getData/`, { method: 'GET' })\r\n            const json = await req.json()\r\n            return json\r\n        } catch (err) {\r\n            console.log('Error fetching data')\r\n        }\r\n    }\r\n    const initController = async () => {\r\n        const data = await getData()\r\n        const propertiesDB = data['propertiesDB']\r\n        const scopesDB = data['scopesDB']\r\n        console.log(data)\r\n        mainConfig = data['clients']\r\n        let tempClients = generateClients(data['clients'], propertiesDB, scopesDB) //Properties DB seems to be passes by reference\r\n        setClients(tempClients)\r\n    }\r\n\r\n    const saveChanges = async () => {\r\n        console.log('Saving: ')\r\n        try {\r\n            await fetch(`/getData/`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(mainConfig),\r\n            })\r\n        } catch (err) {\r\n            console.log(err)\r\n        }\r\n    }\r\n\r\n    if (clients.length > 0) {\r\n        return (\r\n            <div style={{ textAlign: 'center', marginBottom: 20}}>\r\n                <h1>Controls</h1>\r\n                {clients}\r\n                {/* <Client properties={properties} onValueChange={changeValue}></Client> */}\r\n                {/* <ValueChanger onValueChange={sendChange} name=\"temperature\" value={10}></ValueChanger> */}\r\n                <Button variant=\"contained\" color=\"primary\" onClick={() => saveChanges()} sx={{marginTop: 1, width: 1}}>\r\n                    Save Changes\r\n                </Button>\r\n            </div>\r\n        )\r\n    } else {\r\n        return (\r\n            <div style={{marginTop: '50px'}}>\r\n                  <LoadingButton\r\n          onClick={() => {\r\n            setIsLoading(true)\r\n            initController()\r\n          }}\r\n          loading={isLoading}\r\n          loadingIndicator=\"Loadingâ€¦\"\r\n          variant=\"contained\"\r\n        >\r\n          Fetch data\r\n        </LoadingButton>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Controller\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}