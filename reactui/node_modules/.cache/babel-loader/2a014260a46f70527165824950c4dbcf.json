{"ast":null,"code":"import _regeneratorRuntime from\"C:/Code/ReactUI/React/reactui/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Code/ReactUI/React/reactui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Code/ReactUI/React/reactui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Button from'@mui/material/Button';import LoadingButton from'@mui/lab/LoadingButton';import Client from'./Client.js';import React,{useState}from'react';import{loadYAML}from'./YAML.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var mainConfig;//Value:Label Mappings,\n//collapsbible, make scopes to names instead of numbers, change to array for order,\nfunction Controller(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),clients=_useState2[0],setClients=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var yamlFile=loadYAML('test.yml');var homeButton=/*#__PURE__*/_jsx(Button,{onClick:function onClick(){fetch('/profile').then(function(res){return console.log(res);});},children:\"Home\"});console.log('Controller rerender');var changeValue=function changeValue(_ref){var _ref2=_slicedToArray(_ref,2),clientNumber=_ref2[0],_ref2$=_slicedToArray(_ref2[1],2),keyHistory=_ref2$[0],newValue=_ref2$[1];//Array destructuring. Will take the array of property and value and make it into two variables.\nvar client=mainConfig[clientNumber];//console.log(client);\nconsole.log(keyHistory);console.log(newValue);for(var i=0;i<keyHistory.length-1;i++){//Go through keyhistory (except last one). Now client is pointing to the last object which is the {proprety: value}.\nclient=client[keyHistory[i]];}client[keyHistory[keyHistory.length-1]]=newValue;//     console.log(client);\nconsole.log(mainConfig);};var generateClients=function generateClients(json,propertiesDB,scopesDB){var tempArray=[];for(var _i=0,_Object$entries=Object.entries(json);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),clientNumber=_Object$entries$_i[0],clientData=_Object$entries$_i[1];tempArray.push(/*#__PURE__*/_jsx(Client,{sx:{},clientNumber:clientNumber,properties:clientData,propertiesDB:propertiesDB,scopesDB:scopesDB,onValueChange:changeValue},clientNumber));}return tempArray;};var getData=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var req,json;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"/getData/\",{method:'GET'});case 3:req=_context.sent;_context.next=6;return req.json();case 6:json=_context.sent;return _context.abrupt(\"return\",json);case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log('Error fetching data');case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function getData(){return _ref3.apply(this,arguments);};}();var initController=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var data,propertiesDB,scopesDB,tempClients;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getData();case 2:data=_context2.sent;propertiesDB=data['propertiesDB'];scopesDB=data['scopesDB'];console.log(data);mainConfig=data['clients'];tempClients=generateClients(data['clients'],propertiesDB,scopesDB);//Properties DB seems to be passes by reference\nsetClients(tempClients);case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function initController(){return _ref4.apply(this,arguments);};}();var saveChanges=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log('Saving: ');_context3.prev=1;_context3.next=4;return fetch(\"/getData/\",{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(mainConfig)});case 4:_context3.next=9;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](1);console.log(_context3.t0);case 9:case\"end\":return _context3.stop();}}},_callee3,null,[[1,6]]);}));return function saveChanges(){return _ref5.apply(this,arguments);};}();if(clients.length>0){return/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',marginBottom:20},children:[homeButton,/*#__PURE__*/_jsx(\"h1\",{children:\"Controls\"}),clients,/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:function onClick(){return saveChanges();},sx:{marginTop:1,width:1},children:\"Save Changes\"})]});}else{return/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'50px'},children:[homeButton,/*#__PURE__*/_jsx(LoadingButton,{onClick:function onClick(){setIsLoading(true);initController();},loading:isLoading,loadingIndicator:\"Loading\\u2026\",variant:\"contained\",children:\"Fetch data\"})]});}}export default Controller;","map":{"version":3,"names":["Button","LoadingButton","Client","React","useState","loadYAML","mainConfig","Controller","props","clients","setClients","isLoading","setIsLoading","yamlFile","homeButton","fetch","then","res","console","log","changeValue","clientNumber","keyHistory","newValue","client","i","length","generateClients","json","propertiesDB","scopesDB","tempArray","Object","entries","clientData","push","getData","method","req","initController","data","tempClients","saveChanges","headers","body","JSON","stringify","textAlign","marginBottom","marginTop","width"],"sources":["C:/Code/ReactUI/React/reactui/src/Controller.js"],"sourcesContent":["import Button from '@mui/material/Button'\r\nimport LoadingButton from '@mui/lab/LoadingButton';\r\nimport Client from './Client.js'\r\nimport React, { useState } from 'react'\r\n\r\nimport { loadYAML } from './YAML.js'\r\nlet mainConfig\r\n//Value:Label Mappings,\r\n//collapsbible, make scopes to names instead of numbers, change to array for order,\r\nfunction Controller(props) {\r\n    const [clients, setClients] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(false)\r\n    const yamlFile = loadYAML('test.yml')\r\n\r\n    const homeButton = (<Button onClick={() => {\r\n        fetch('/profile').then(res => console.log(res))\r\n    }}>Home</Button>)\r\n    console.log('Controller rerender')\r\n\r\n    const changeValue = ([clientNumber, [keyHistory, newValue]]) => {\r\n        //Array destructuring. Will take the array of property and value and make it into two variables.\r\n        let client = mainConfig[clientNumber]\r\n        //console.log(client);\r\n        console.log(keyHistory)\r\n        console.log(newValue)\r\n        for (let i = 0; i < keyHistory.length - 1; i++) {\r\n            //Go through keyhistory (except last one). Now client is pointing to the last object which is the {proprety: value}.\r\n            client = client[keyHistory[i]]\r\n        }\r\n        client[keyHistory[keyHistory.length - 1]] = newValue\r\n        //     console.log(client);\r\n        console.log(mainConfig)\r\n    }\r\n    const generateClients = (json, propertiesDB, scopesDB) => {\r\n        let tempArray = []\r\n        for (const [clientNumber, clientData] of Object.entries(json)) {\r\n            tempArray.push(\r\n                <Client\r\n                    sx={{}}\r\n                    key={clientNumber}\r\n                    clientNumber={clientNumber}\r\n                    properties={clientData}\r\n                    propertiesDB={propertiesDB}\r\n                    scopesDB={scopesDB}\r\n                    onValueChange={changeValue}\r\n                ></Client>\r\n            )\r\n        }\r\n        return tempArray\r\n    }\r\n\r\n    const getData = async () => {\r\n        try {\r\n            const req = await fetch(`/getData/`, { method: 'GET' })\r\n            const json = await req.json()\r\n            return json\r\n        } catch (err) {\r\n            console.log('Error fetching data')\r\n        }\r\n    }\r\n    const initController = async () => {\r\n        const data = await getData()\r\n        const propertiesDB = data['propertiesDB']\r\n        const scopesDB = data['scopesDB']\r\n        console.log(data)\r\n        mainConfig = data['clients']\r\n        let tempClients = generateClients(data['clients'], propertiesDB, scopesDB) //Properties DB seems to be passes by reference\r\n        setClients(tempClients)\r\n    }\r\n\r\n    const saveChanges = async () => {\r\n        console.log('Saving: ')\r\n        try {\r\n            await fetch(`/getData/`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(mainConfig),\r\n            })\r\n        } catch (err) {\r\n            console.log(err)\r\n        }\r\n    }\r\n\r\n    if (clients.length > 0) {\r\n        return (\r\n            <div style={{ textAlign: 'center', marginBottom: 20}}>\r\n                {homeButton}\r\n                <h1>Controls</h1>\r\n                {clients}\r\n                {/* <Client properties={properties} onValueChange={changeValue}></Client> */}\r\n                {/* <ValueChanger onValueChange={sendChange} name=\"temperature\" value={10}></ValueChanger> */}\r\n                <Button variant=\"contained\" color=\"primary\" onClick={() => saveChanges()} sx={{marginTop: 1, width: 1}}>\r\n                    Save Changes\r\n                </Button>\r\n            </div>\r\n        )\r\n    } else {\r\n        return (\r\n            <div style={{marginTop: '50px'}}>\r\n                {homeButton}\r\n                  <LoadingButton\r\n          onClick={() => {\r\n            setIsLoading(true)\r\n            initController()\r\n          }}\r\n          loading={isLoading}\r\n          loadingIndicator=\"Loading…\"\r\n          variant=\"contained\"\r\n        >\r\n          Fetch data\r\n        </LoadingButton>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Controller\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}